export const BUILDING_TYPES = {
  CLOCKWORK_FORGE: 'clockwork_forge',
  STEAM_MILL: 'steam_mill',
  CRYSTAL_REFINERY: 'crystal_refinery',
  AIRSHIP_DOCK: 'airship_dock',
  INVENTORS_WORKSHOP: 'inventors_workshop',
  EXPLORERS_GUILD: 'explorers_guild',
  COTTAGE: 'cottage',
  TESLA_TOWER: 'tesla_tower',
  WATCHTOWER: 'watchtower',
  AETHER_FOUNDRY: 'aether_foundry',
  SKY_FORTRESS: 'sky_fortress',
  GRAND_CLOCKTOWER: 'grand_clocktower',
  MANSION: 'mansion',
  AETHER_CONDUIT: 'aether_conduit',
}

export const BUILDINGS = {
  // --- Tier 1: Starter buildings ---
  [BUILDING_TYPES.CLOCKWORK_FORGE]: {
    name: 'Clockwork Forge',
    description: 'Produces 5 Gears per tick. Gears are needed for most advanced buildings.',
    cost: { wood: 40, stone: 30, metal: 20 },
    buildTime: 15,
    produces: { gears: 5 },
    color: '#b87333',
    emissive: '#8b4513',
  },
  [BUILDING_TYPES.STEAM_MILL]: {
    name: 'Steam Mill',
    description: 'Produces 3 Steam per tick. Steam powers advanced structures and unlocks new plots.',
    cost: { wood: 30, stone: 40, water: 30 },
    buildTime: 20,
    produces: { steam: 3 },
    color: '#9ca3af',
    emissive: '#6b7280',
  },
  [BUILDING_TYPES.COTTAGE]: {
    name: "Quaint Cottage",
    description: 'Houses up to 4 extra villagers. Build more to attract wanderers and grow your population.',
    cost: { wood: 40, stone: 30 },
    buildTime: 15,
    produces: {},
    special: 'housing',
    capacity: 4,
    color: '#f59e0b',
    emissive: '#d97706',
  },
  [BUILDING_TYPES.WATCHTOWER]: {
    name: "Watchtower",
    description: 'Slows all enemies within range 6. Gives you more time to react to raids.',
    cost: { wood: 50, stone: 40 },
    buildTime: 20,
    produces: {},
    special: 'vision',
    range: 6,
    color: '#fbbf24',
    emissive: '#d97706',
  },

  // --- Tier 2: Mid-game buildings (require processed resources) ---
  [BUILDING_TYPES.CRYSTAL_REFINERY]: {
    name: 'Crystal Refinery',
    description: 'Produces 1 Crystal per tick. Crystals are rare and needed for Tier 3 buildings.',
    cost: { metal: 50, gears: 80, steam: 60 },
    buildTime: 40,
    produces: { crystals: 1 },
    color: '#a855f7',
    emissive: '#7c3aed',
  },
  [BUILDING_TYPES.TESLA_TOWER]: {
    name: "Tesla Tower",
    description: 'Automatically zaps enemies within range 3 for 10 damage. Your primary defense against raids.',
    cost: { metal: 60, gears: 80, steam: 40, crystals: 15 },
    buildTime: 35,
    produces: {},
    special: 'defense',
    range: 3,
    damage: 10,
    color: '#38bdf8',
    emissive: '#0284c7',
  },
  [BUILDING_TYPES.EXPLORERS_GUILD]: {
    name: "Explorer's Guild",
    description: 'Unlocks new 8x8 land plots via the plot navigator. Expand your territory to find more nodes and outposts.',
    cost: { wood: 60, stone: 50, gears: 80, steam: 60 },
    buildTime: 45,
    produces: {},
    special: 'explorer',
    color: '#10b981',
    emissive: '#059669',
  },
  [BUILDING_TYPES.AIRSHIP_DOCK]: {
    name: 'Airship Dock',
    description: 'Doubles all resource production for 30 seconds when activated. One-time boost per dock.',
    cost: { wood: 70, metal: 50, gears: 100, steam: 60 },
    buildTime: 50,
    produces: {},
    special: 'trade_boost',
    boostDuration: 30,
    color: '#78716c',
    emissive: '#57534e',
  },
  [BUILDING_TYPES.INVENTORS_WORKSHOP]: {
    name: "Inventor's Workshop",
    description: 'Generates 1 Blueprint every 10 ticks. Blueprints are required for all Tier 3 buildings.',
    cost: { metal: 80, gears: 120, steam: 80, crystals: 25 },
    buildTime: 60,
    produces: {},
    special: 'blueprints',
    color: '#2563eb',
    emissive: '#1d4ed8',
  },

  // --- Tier 3: Late-game buildings (heavy multi-resource investment) ---
  [BUILDING_TYPES.AETHER_FOUNDRY]: {
    name: 'Aether Foundry',
    description: 'Produces 4 Crystals per tick — four times a Crystal Refinery. Fuels your endgame economy.',
    cost: { metal: 200, gears: 300, steam: 150, crystals: 80, blueprints: 30 },
    buildTime: 90,
    produces: { crystals: 4 },
    tier: 3,
    color: '#c084fc',
    emissive: '#9333ea',
  },
  [BUILDING_TYPES.SKY_FORTRESS]: {
    name: 'Sky Fortress',
    description: 'Superior defense: zaps enemies within range 5 for 25 damage. Far stronger than a Tesla Tower.',
    cost: { stone: 250, metal: 200, gears: 250, crystals: 100, blueprints: 40 },
    buildTime: 120,
    produces: {},
    special: 'defense',
    range: 5,
    damage: 25,
    tier: 3,
    color: '#64748b',
    emissive: '#475569',
  },
  [BUILDING_TYPES.GRAND_CLOCKTOWER]: {
    name: 'Grand Clocktower',
    description: 'Boosts all buildings on the same plot by +50% production. Stacks with trade boosts.',
    cost: { wood: 150, stone: 200, gears: 350, steam: 120, blueprints: 50 },
    buildTime: 100,
    produces: {},
    special: 'production_aura',
    tier: 3,
    color: '#fbbf24',
    emissive: '#b45309',
  },
  [BUILDING_TYPES.MANSION]: {
    name: 'Grand Mansion',
    description: 'Houses up to 10 extra villagers — more than twice a Cottage. Essential for large settlements.',
    cost: { wood: 180, stone: 150, gears: 120, crystals: 50 },
    buildTime: 60,
    produces: {},
    special: 'housing',
    capacity: 10,
    tier: 3,
    color: '#e11d48',
    emissive: '#9f1239',
  },

  // --- Wonder: Prestige mega-structure ---
  [BUILDING_TYPES.AETHER_CONDUIT]: {
    name: 'Aether Conduit',
    description: 'Produces ALL resources at 3/tick plus Blueprints. Only one can exist. The ultimate achievement.',
    cost: { gears: 500, steam: 400, crystals: 250, blueprints: 100, wood: 300, stone: 300, metal: 300 },
    buildTime: 300,
    produces: { gears: 3, steam: 3, crystals: 3, wood: 3, stone: 3, metal: 3, water: 3 },
    special: 'wonder',
    tier: 3,
    color: '#e0f2fe',
    emissive: '#7dd3fc',
  },
}

export function canAfford(resources, buildingType) {
  const cost = BUILDINGS[buildingType].cost
  return Object.entries(cost).every(
    ([resource, amount]) => (resources[resource] || 0) >= amount
  )
}
